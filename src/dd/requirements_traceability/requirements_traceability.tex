In this chapter we will describe how the design element defined in the previous sections will meet the functional and non-functional requirements listed in the RASD document.

\section{Functional Requirements}

\begin{center}
\begin{longtable}{|p{0.1\textwidth}|p{0.3\textwidth}|>{\raggedright\arraybackslash}p{0.2\textwidth}|>{\raggedright\arraybackslash}p{0.4\textwidth}|}
\hline
\multicolumn{2}{|c|}{\textbf{Requirement}} & \multicolumn{2}{c|}{\textbf{Design Solution}} \\ \hline
R.1.1 & The system must turn the state of the car from reserved to available if the user did not unlock it within an hour since the moment of the reservation. & CMP: \linebreak Car Manager & The CarManager monitors every reservation and it takes care of doing this.  \\ \hline
R.1.2 & The system must turn the state of the car from available to reserved after the user reserves it. & CMP: Car Manager & The CarManager does it. \\ \hline
R.2.1 & The system must be able to check the position of the user through the GPS position of his mobile phone. & CMP: Car Manager & When a user wants to unlock a car through the mobile app, it does this check. \\ \hline
R.2.2 & The system must be able to show all the available cars, with their current level of battery, within a range of 1 km from the position of the user. & CMP: Car Manager & The function \textit{List \textless Car\textgreater{} getAvailableCars(Position center, float radius)} does it if the center is the position of the user and if the radius is equal to 1000. \\ \hline
R.2.3 & If there are not any available cars within a range of 1 km from the position of the user the system must notify the user. & CMP: Car Manager & The function \textit{List \textless Car\textgreater{} getAvailableCars(Position center, float radius)} returns an empty list and the client can advise the user. \\ \hline
R.3.1 & The system must be able to identify a specified location. & CMP: Google Maps API & Through the Google Maps APIs the system is able to do it. \\ \hline
R.3.2 & The system must be able to show all the available cars, with their current level of battery, within a range of 1 km from that specific location. & CMP: Car Manager & The function \textit{List \textless Car\textgreater{} getAvailableCars(Position center, float radius)} does it if the center is the desired location and if the radius is equal to 1000. \\ \hline
R.3.3 & If there are not any available cars within a range of 1 km from that specific location the system must notify the user. & CMP: Car Manager & The function \textit{List \textless Car\textgreater{} getAvailableCars(Position center, float radius)} returns an empty list and the client can advise the user. \\ \hline
R.4.1 & The system must be able to check if the user who wants to unlock the car is the same who reserved it. & CMP: Car Manager & The function \textit{void unlockCar(String plate)} does this check. \\ \hline
R.5.1 & The system must be able to show to the user the position of the safe areas on the map. & CMP: Safe Area Manager & The function \textit{List \textless SafeArea\textgreater{} getSafeAreas()} does it. \\ \hline
R.5.2 & The system must notify the user when he/she is inside a safe area. & CMP: Google Maps APIs & Through the Google Maps APIs the client is able to do it. \\ \hline
R.5.3 & The system must end the reservation only when the car is parked in a safe area and the user exits the vehicle. & CMP: Car Manager & The function \textit{void endRide(int maxNumberOfPassengers)} does this check. \\ \hline
R.5.4 & When the reservation ends the system must change the status of the car in available and lock the car. & CMP: Car Manager & The function \textit{void endRide(int maxNumberOfPassengers)} does it. \\ \hline
R.6.1 & The system must be able to calculate the distance between the car and the mobile phone of the user using the GPS positions. & CMP: Car Manager & The Car Manager is able to do it. \\ \hline
R.6.2 & The system must show to the user the option to unlock the car at least when the distance between the car and the mobile phone of the user is less than 6 meters. & Mobile app UI & The Mobile app UI shows this option when the user has a reserved a car. \\ \hline
R.6.3 & The system must be able to unlock the cars remotely. & CMP: Car Manager & The function \textit{void unlockCar(String plate)} does it. \\ \hline
R.6.4 & The system must be notified when the user enter inside the car. & CMP: Car Manager & The function \textit{void unlockCar(String plate)} does it. \\ \hline
R.6.5 & The system must be able to lock the car again if the user doesn't enter inside the car within 3 minutes. & CMP: Car Manager & The Car Manager does it. \\ \hline
R.7.1 & The system must be able to calculate the current fee with respect to the amount of money per minute defined by the company. & CMP: Fee Manager & The Fee Manager does it. \\ \hline
R.7.2 & The system must be able to show on the tablet present on the car the current fee that the user has to pay. & Fee Manager & The function \textit{float getFeeWithVariation(String ID)} can send the current fee to the car tablet. \\ \hline
R.8.1 & The system must be able to show to the user the position of the power grid station. & CMP: Safe Area Manager & The function \textit{List \textless Position\textgreater{} getPowerGridStations()} does it. \\ \hline
R.8.2 & The system must be able to show to the user the number of free plugs in every power grid station. & CMP: Safe Area Manager & The function \textit{int getFreePlugsNumber(Position powerGridStationCenter)} does it. \\ \hline
R.9.1 & The system must allow only the users that has not been banned to search for a car. & CMP: Car Manager & The Car Manager does this check. \\ \hline
R.9.2 & The system must allow only the users that has not been banned to reserve a car. & CMP: Car Manager & The Car Manager does this check. \\ \hline
R.9.3 & The system must be able to know the result of the payment operation. & CMP: Payments Manager & The function \textit{void payRide(String ID)} does it. \\ \hline
R.9.4 & The system must ban a user that has a pending fee. & CMP: User Manager & The User Manager does it. \\ \hline
R.9.5 & The system must be able to mark a fee as paid if and only if the payment operation is successful. & CMP: Payments Manager & The Payments Manager does it. \\ \hline
R.9.6 & The system must be able to remove the ban from the user when his/her pending fee has been extinguished. & CMP: User Manager, Payments Manager & The User Manager and the Payments Manager do it. \\ \hline
R.10.1 & The system must allow the user to enable the saving mode option in every moment from when he/she starts ride. & CMP: Fee Manager & The function \textit{PowerGridStation enableMoneySavingOption()} does it. \\ \hline
R.10.2 & The system must be able to recognize the best power grid to station where to park a specified car based on its position and the distribution of the other cars of PowerEnJoy. & CMP: Fee Manager, Safe Area Manager. ALG: 4 & The function \textit{PowerGridStation enableMoneySavingOption()} does it. \\ \hline
R.10.3 & The system must be able to provide information about the station where to leave the car to obtain a discount. & CMP: Fee Manager & The function \textit{PowerGridStation enableMoneySavingOption()} does it. \\ \hline
R.10.4 & The system must ask the user his/her destination. & Car tablet UI & The car tablet UI does it. \\ \hline
R.10.5 & The system must be able to check the availability of power plug in a specific station. & CMP: Safe Area Manager & The function \textit{int getFreePlugsNumber(Position powerGridStationCenter)} does it. \\ \hline
R.11.1 & There must be some maintainers that repair every broken car after at maximum two working days after the time they broke. & CMP: Car Manager & The function \textit{void reportFailedCar()} signals that the car is broken, then the car Manager send a request to the maintainers external service, which ensure us that the car will be repaired in that period of time. \\ \hline
R.11.2 & There must be some maintainers that recharge the cars after at maximum one working day after the time they discharged. & CMP: Car Manager & The HandyCar Board signals to the application server when a car is discharged, then the car Manager send a request to the maintainers external service, which ensure us that the car will be charged in that period of time. \\ \hline
R.11.3 & The system must be able to identify a lack of cars in some parts of the city. & CMP: Car Manager. ALG: 4 & The Car Manager is able to do it. \\ \hline
R.11.4 & If there is a lack of cars in some parts of the city, the system has to notify the maintainers. & CMP: Car Manager & The Car Manager does it. \\ \hline
R.12.1 & The system must be able to detect that there are at least two passengers (not including the driver) on the car and in this case it applies a discount of 10\% on the final fee of that ride. & CMP: Car Manager, Fee Manager & The function \textit{void endRide(int maxNumberOfPassengers)} communicates the maximum number of passengers and the Fee Manager applies the discount if it is compatible. \\ \hline
R.12.2 & The system must be able to detect if the battery level at the end of the ride is greater or equal to the 50\% of the total battery level and in this case it applies a discount of 20\% on the final fee of that ride. & CMP: Car Manager, Fee Manager & The Car Manager does this check and the Fee Manager applies the discount if it is compatible. \\ \hline
R.12.3 & The system must be able to detect if the car is in a recharging station area and it is plugged to the power grid when the reservation ends, in this case it applies a discount of 30\% on the final fee of that ride. & CMP: Car Manager, Fee Manager & The Car Manager does this check and the Fee Manager applies the discount if it is compatible. \\ \hline
R.12.4 & The system must be able to detect if the battery level at the end of the ride is less than 20\% of the total battery level, in this case the system applies a raise of 30\% on the final fee of that ride. & CMP: Car Manager, Fee Manager & The Car Manager does this check and the Fee Manager applies the discount if it is compatible. \\ \hline
R.12.5 & The system must be able to detect if the car is left more than 3 Km away from the nearest recharging station, in this case the system applies a raise of 30\% on the final fee of that ride. & CMP: Car Manager, Safe Area Manager, Fee Manager & The Car Manager communicates the position of the car to the Safe Area Manager, which checks if the distance is respected and in this case, it communicates this to the Fee Manager, that applies the discount. \\ \hline
R.13.1 & The system must be able to acquire all the informations for the registration (name, surname, email address, username, birth date, driving license and payment information). & CMP: User Manager & The User Manager does it. \\ \hline
R.13.2 & The system must be able to check if all the mandatory fields has been completed with valid data. & CMP: User Manager & The User Manager does it. \\ \hline
R.13.3 & The system must be able to check the validity of the driving license through an external service. & CMP: User Manager & The User Manager does it. \\ \hline
R.13.4 & The system must be able to check the validity of the payment information through an external service. & CMP: Payments Manager & The Payments Manager does it. \\ \hline
R.14.1 & The system must be able to check if the username and password provided are correct. & CMP: User Manager & The User Manager is able to do it. \\ \hline
R.14.2 & The system must allow the user login if and only if the provided username and the password are correct. & CMP: User Manager & The User Manager does this check. \\ \hline

\caption{Requirements traceability table} 
\label{tab:reqTraceTable}
\end{longtable} 
\end{center}