\section{Use Case Description}
In this paragraph some use cases will be described. These use cases can be derived from the scenarios and the use case diagram.\\
\\
\textbf{User registration} \\
\\
\textbf{Name:}User registration \\
\textbf{Actors:}User,External system for Payments \\
\textbf{Entry conditions:}User is not registered to the system \\
\textbf{Flow of events:} \\
\begin{itemize}
\item The user open the application and click on the button sign up in the homepage;
\item The system show him/her a registration form;
\item The user fill the form with his/her data: name,surname, birth date, driving licence number, credit card number, username and password. Then he/she submit it;
\item The system check the correctness of the data inserted by the user and verify the validity of the credit card through an external system;
\item If all the data are correct the system send him/her a confirmation email of the registration;
\end{itemize}
\textbf{Exit conditions:}The user is successfully registered to the system and now can log in.\\
\textbf{Exceptions:}
\begin{itemize}
\item The information inserted by the user are not valid or some informations are missing.
In this the registration fails and the user is redirected to the homepage.
\item The external system for credit card validation is not available. In this case the user cannot complete the registration until the problem will be fixed.
\end{itemize}


\textbf{User log in} \\
\\
\textbf{Name:} User log in \\
\textbf{Actors:} User \\
\textbf{Entry conditions:} The user is registered to the system and he/she is not banned\\
\textbf{Flow of events:}
\begin{itemize}
\item The user open the application and click on the button log in in the homepage;
\item The system show him a form in which he/she can insert the username and the password;
\item The user fill the form and then click submit it;
\item The system check that the username and password are correct;
\end{itemize}
\textbf{Exit conditions:} The user is successfully logged into the system and now he/she can access to all its functionalities \\
\textbf{Exceptions:} \\
The username and password inserted by the user are not correct.In this case the user is not logged in and he/she will be redirected to the homepage.\\

\textbf{Search Car}\\
\\
\textbf{Name:} Search Car + Search from current location + Search in a specific address\\
\textbf{Actors:} User\\
\textbf{Entry conditions:} The user is logged into the system and he/she is not banned\\
\textbf{Flow of events:}
\begin{itemize}
\item The user choose the option "Search Car"
\item The system allows the user to choose one of the 2 options for searching the car: "Search in a specific address" or "Search from current location".
\item If the user choose "Search in a specific address" the system will ask him/her to insert the address and then it will verify the correctness of the inserted data;
\item If the user choose "Search from current location" the system will detect his/her position through the GPS and it will search for car within a range of 1 km from the user's position.
\item The system will show on the map the available cars that satisfy the parameters,with their number and their current battery.
\end{itemize}
\textbf{Exit conditions:} The user can visualize on the map the available cars that fits the parameters \\
\textbf{Exceptions:}  
\begin{itemize}
\item The are no available cars that satisfy the parameters. In this case the user is notified of the unavailability of cars.
\item The address inserted by the user is not correct. In this case the system will ask the user to insert it again
\end{itemize}

\textbf{Reserve Car}\\
\\
\textbf{Name:} Reserve Car\\
\textbf{Actors:} User\\
\textbf{Entry conditions:}
 \begin{itemize}
\item The user is logged into the system and he/she is not banned;
\item The user have used the "Search Car" function and have displayed the results on the map
\end{itemize}
\textbf{Flow of events:}
\begin{itemize}
\item The user select one of the car that he/she can visualize on the map;
\item The system show the user all the informations about the selected car and show him/her an option to reserve it;
\item The system check that the car is still available and that the user has not any other reservation;
\item If the car is still available send the reservation to the car;
\item The system notify the user about the result of the operation;
\end{itemize}
\textbf{Exit conditions:} The car is reserved by the user  \\
\textbf{Exceptions:}
\begin{itemize}
\item The car is not available any more. In this case the user is notified and he/she is redirected to the map where he/she can choose another car;
\item The user has already reserved another car. In this case the user is notified and redirected to the homepage;
\end{itemize}


\textbf{Ride}\\
\\
\textbf{Name:} Ride\\
\textbf{Actors:} User and other people that don't necessarily need to be registered in to the system\\
\textbf{Entry conditions:}
\begin{itemize}
\item The user is logged in
\item The user in not banned
\item The user that pick up the car is the same user that has reserved it
\end{itemize}
\textbf{Flow of events:}
\begin{itemize}
\item The user reach the location of the car following the direction given by the mobile app;
\item The system show on the mobile phone of the user the option to unlock the car when he/she is within a range of 6 metres from the car
\item The user choose to unlock the car;
\item The system take charge the request and unlock the car;
\item The user and the passenger(in case there are any) enter inside the car;
\item The user ignite the engine and the system is notified;
\item The system start charging the user with a predefined amount of money per minute and show him/her the current fee on the screen of the car;
\end{itemize}
\textbf{Exit conditions:} The user is now able to drive the car \\
\textbf{Exceptions:}
\begin{itemize}
\item The user has unlocked the car but after 3 minutes he/she is not entered inside the car. In this case  the car will be locked again and its status changed in available;
\item The user cannot unlock the car even if he/she is within a range of 6 metres from the car. In this case he/she will can use the help button  to notify the problem to the system;
\end{itemize}



\textbf{Reservation Expire}\\
\\
\textbf{Name:} Reservation Expire\\
\textbf{Actors:} User, External system for payments\\
\textbf{Entry conditions:}
\begin{itemize}
\item The user is logged into the system and he/she is not banned;
\item The user has reserved a car;
\item One hour has passed from the user's reservation;
\end{itemize}
\textbf{Flow of events:}
\begin{itemize}
\item The status of the car changes from booked to available if the system verify that the car has not been picked-up by the user;
\item The system charge 1 euro to the user;
\item The external system for payments take charge of the request and invoke the \textbf{Payment} use case;
\item The user is notified about the result of the operation;
\end{itemize}
\textbf{Exit conditions:} The user is now able to reserve a new car \\
\textbf{Exceptions:}
\begin{itemize}
\item The payment is not successful. In this case the user is notified and banned from the system;
\item The external system for payments in not available. In this case the payment will be performed as soon as the it will become available again
\end{itemize}

\textbf{Recharge Car}\\
\\
\textbf{Name:} Recharge Car\\
\textbf{Actors:} User, other passengers that are not necessarily registered into the system,Maintainer\\
\textbf{Entry conditions:}
\begin{itemize}
\item The car is parked next to a power grid inside a special area;
\item The engine of the car is off;
\end{itemize}
\textbf{Flow of events:}
\begin{itemize}
\item The user or one of the passenger go out of the car and plug the car in one of the power grid;
\item The user end the ride;
\item The system is notified when the car is plugged into the power grid;
\end{itemize}
\textbf{Exit conditions:} The car has been recharged \\
\textbf{Exceptions:}
\begin{itemize}
\item The car has been parked in an unsafe area or is not able to reach the nearest power grid station with the current battery. In this case the maintainer reach the area where the car has been parked and start charging the car on site. At this point the system is notified that the car has been charged by the maintainer;
\item The power grid has  a problem and doesn't recharge the car. In this case the user can use the help button and notify the problem to the system;
\item The user recharge the car and don't end the ride. In this case he/she can continue to use it but the discount for the battery plug-in won't be calculated.
\end{itemize}

\textbf{End Ride}\\
\\
\textbf{Name:} End Ride\\
\textbf{Actors:} User, other passengers that are not necessarily registered into the system\\
\textbf{Entry conditions:}
\begin{itemize}
\item The car is inside a safe area
\item The user decide to end the ride;
\end{itemize}
\textbf{Flow of events:}
\begin{itemize}
\item The user turn off the engine of the car and click on the proper button to end the ride;
\item The system is notified about the ride;
\item The system wait until there are no passengers on the car;
\item The system and stop charging the user
\item The system detect if the car has been parked in a safe area or in a special area where it can be recharged. In the second case the system wait 10 minutes before start calculating the bill;
\item The system lock the car and change his status from busy to available;
\item The system invoke the \textbf{Discount calculation} use case;
\item The system charge the calculated bill to the user;
\item The system invoke the \textbf{Payment} use case;
\end{itemize}
\textbf{Exit conditions:}
\begin{itemize}
\item The car is available again;
\item The user is able to reserve another car
\end{itemize}
\textbf{Exceptions:}
\begin{itemize}
\item The user leave the car outside a safe area. In this case the the user cannot end the ride and he/she will continue to pay until the limit time for a reservation has been reached. In addiction a maintainer will take charge of moving the car to a safe area.
\item The user turn off the car but the passenger or the user don't go out of the car within 3 minutes. In this case the system will start charging and additional fee per minute to the user.
\item The payment is not successful. In this case the user is notified and banned from the system;
\item The external system for payments in not available. In this case the payment will be performed as soon as the it will become available again
\end{itemize}



 





