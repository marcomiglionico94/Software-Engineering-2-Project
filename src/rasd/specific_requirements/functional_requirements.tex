\section{Goals and Functional Requirements}
% Definition of use case diagrams, use cases and associated sequence/activity diagrams
Assuming that the domain properties stipulated in the paragraph [2.5] hold, here are presented all the goal to  achieve and the requirements, grouped under each goal from which they are derived.

\begin{enumerate}

\item {[G1]} Allows the user to reserve a car for up to an hour before he/she picks it up:

\begin{itemize}
	\item {[R1]} The system must turn the state of the car from reserved to available if the user did not unlock it within an hour since the moment of the reservation;
	\item {[R2]} The system must turn the state of the car from available to reserved after the user reserves it.
\end{itemize}

\item {[G2]} Allows the user to find the closest cars with respect to his/her position:

\begin{itemize}
	\item {[R1]} The system must be able to check the position of the user through the GPS position of his mobile phone;
	\item {[R2]} The system must be able to show all the available cars, with their current level of battery, within a range of 1 km from the position of the user;
	\item {[R3]} If there are not any available cars within a range of 1 km from the position of the user the system must notify the user.
\end{itemize}

\item {[G3]} Allows the user to search for a car in a specific location:

\begin{itemize}
	\item {[R1]} The system must ask the user to insert a specific location;
	\item {[R2]} The system must be able to identify a specified location;
	\item {[R3]} The system must be able to show all the available cars, with their current level of battery, within a range of 1 km from that specific location;
	\item {[R4]} If there are not any available cars within a range of 1 km from that specific location the system must notify the user.
\end{itemize}

\item {[G4]} Allows to unlock a car only to the user who currently reserved it:

\begin{itemize}
	\item {[R1]} The system must be able to check if the user who wants to unlock the car is the same who reserved it;
\end{itemize}

\item {[G5]} Allows the user to end the ride only in specific areas called safe areas:

\begin{itemize}
	\item {[R1]} The system must be able to show to the user the position of the safe areas on the map;
	\item {[R2]} The system must notify the user when he/she is inside a safe area;
	\item {[R3]} The system must end the reservation only when the car is parked in a safe area and the user exits the vehicle;
	\item {[R4]} When the reservation ends the system must change the status of the car in available and lock the car.
\end{itemize}

\item {[G6]} Allows the user to unlock the vehicle when he/she is next to it using the mobile app:

\begin{itemize}
	\item {[R1]} The system must be able to calculate the distance between the car and the mobile phone of the user using the GPS positions;
	\item {[R2]} When the distance between the car and the mobile phone of the user is less than 6 meters the system must show to the user the option to unlock the car;
	\item {[R3]} The system must be able to unlock the cars remotely;
	\item {[R4]} The system must be notified when the user enter inside the car;
	\item {[R5]} The system must be able to lock the car again if the user doesn't enter inside the car within 3 minutes.
\end{itemize}

\item {[G7]} Allows the user to know the current fee he/she has to pay;

\begin{itemize}
	\item {[R1]} The system must be able to calculate the current fee with respect to the amount of money per minute defined by the company;
	\item {[R2]} The system must be able to show on the tablet present on the car the current fee that the user has to pay.
\end{itemize}

\item {[G8]} Allows the user to recharge a car in power grid stations:

\begin{itemize}
	\item {[R1]} The system must be able to show to the user the position of the power grid stations;
	\item {[R2]} The system must be able to show to the user the number of free plugs in every power grid stations.
\end{itemize}

\item {[G9]} Does not allow user that has not paid the last fee to use the system, banning them until that fee will be paid:

\begin{itemize}
	\item {[R1]} The system must allow only the users that has not been banned to search for a car;
	\item {[R2]} The system must allow only the users that has not been banned to reserve a car;
	\item {[R3]} The system must be able to know the result of the payment operation;
	\item {[R4]} The system must ban a user that has a pending fee;
	\item {[R5]} The system must be able to mark a fee as paid if and only if the payment operation is successful;
	\item {[R6]} The system must be able to remove the ban from the user when his/her pending fee has been extinguished.
\end{itemize}

\item {[G10]} Allows the user to enable the saving money option:

\begin{itemize}
	\item {[R1]} The system must allow the user to enable the saving mode option in every moment from when he/she starts ride;
	\item {[R2]} The system must be able to recognize the best power grid to station where to park a specified car based on its position and the distribution of the other cars of PowerEnJoy;
	\item {[R3]} The system must be able to provide information about the station where to leave the car to obtain a discount;
	\item {[R4]} The system must ask the user his/her destination;
	\item {[R5]} The system must be able to check the availability of power plug in a specific station;
\end{itemize}

\item {[G11]} Keeps the electric cars working, with an high level of battery and well distributed:

\begin{itemize}
	\item {[R1]} There must be some maintainers that repair every broken car after at maximum two working days after the time they broke;
	\item {[R2]} There must be some maintainers that recharge the cars after at maximum one working day after the time they discharged.
	\item {[R3]} The system must be able to identify a lack of cars in some parts of the city.
	\item {[R4]} If there is a lack of cars in some parts of the city, the system has to notify the maintainers.
\end{itemize}

\item {[G12]} Stimulates the virtuous behaviours of the users:

\begin{itemize}
	\item {[R1]} The system must be able to detect that there are at least two passengers (not including the driver) on the car and in this case it applies a discount of 10\% on the final fee of that ride;
	\item {[R2]} The system must be able to detect if the battery level at the end of the ride is greater or equal to the 50\% of the total battery level and in this case it applies a discount of 20\% on the final fee of that ride;
	\item {[R3]} The system must be able to detect if the car is in a recharging station area and it is plugged to the power grid when the reservation ends, in this case it applies a discount of 30\% on the final fee of that ride;
	\item {[R4]} The system must be able to detect if the battery level at the end of the ride is less than 20\% of the total battery level, in this case the system applies a raise of 30\% on the final fee of that ride;
	\item {[R5]} The system must be able to detect if the car is left more than 3 Km away from the nearest recharging station, in this case the system applies a raise of 30\% on the final fee of that ride.
\end{itemize}

\item {[G13]} Allows the user to register to the system if he/she provides valid personal and payment information:

\begin{itemize}
	\item {[R1]} The system must be able to acquire all the informations for the registration (name, surname, email address, username, birth date, driving license and payment information);
	\item {[R2]} The system must be able to check if all the mandatory fields has been completed with valid data;
	\item {[R3]} The system must be able to check the validity of the driving license through an external service;
	\item {[R4]} The system must be able to check the validity of the payment information through an external service.
\end{itemize}

\item {[G14]} Allows only the registered users to log in to the system:

\begin{itemize}
	\item {[R1]} The system must be able to check if the username and password provided are correct;
	\item {[R2]} The system must allow the user login if and only if the provided username and the password are correct.
\end{itemize}

\end{enumerate}